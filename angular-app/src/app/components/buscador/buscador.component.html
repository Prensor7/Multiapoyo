<p-toast></p-toast>

<div class="grid">
    <div class="col-4">
        <p-fieldset legend="Formulario">
            <form [formGroup]="myForm" (ngSubmit)="onSearch()">
                <div class="flex flex-column gap-3">
                    <div class="flex flex-column gap-2">
                        <label for="user">Nombre de usuario</label>
                        <input pInputText id="user" aria-describedby="userhelp" [min]="4" formControlName="usuario" />
                    </div>
                    <div class="flex justify-content-center gap-3">
                        <p-button type="submit" label="Buscar" icon="fa-solid fa-magnifying-glass" severity="info"
                            [raised]="true" [loading]="loading"></p-button>
                        <p-button label="Guardar" icon="fa-solid fa-floppy-disk" severity="success" [raised]="true"
                            [loading]="loading" (onClick)="onSaveUsers()"></p-button>
                    </div>
                </div>
            </form>
        </p-fieldset>
    </div>
    <div class="col-8">
        <p-fieldset legend="Resultados">
            <p-table [value]="listUsuario" [tableStyle]="{ 'min-width': '50rem' }">
                <ng-template #header>
                    <tr>
                        <th>#</th>
                        <th>ID</th>
                        <th>Nombre</th>
                        <th>Avatar</th>
                        <th>Acciones</th>
                    </tr>
                </ng-template>
                <ng-template #body let-user let-ri="rowIndex">
                    <tr>
                        <td>{{(ri+1)}}</td>
                        <td>{{ user.id }}</td>
                        <td>{{ user.login }}</td>
                        <td>
                            <img [src]="user.avatar_url" alt="" width="32" style="vertical-align: middle">
                        </td>
                        <td class="flex gap-2">
                            <p-button icon="fa-brands fa-github" severity="info" [raised]="true" pTooltip="Ir al perfil"
                                tooltipPosition="bottom" (onClick)="onOpenGitHub(user.html_url)"></p-button>
                            <p-button icon="fa-solid fa-user-tie" severity="success" [raised]="true"
                                pTooltip="Abrir información" tooltipPosition="bottom"
                                (onClick)="onOpenInfo(user.login)"></p-button>
                        </td>
                    </tr>
                </ng-template>
            </p-table>
        </p-fieldset>
    </div>
</div>

<p-dialog header="Perfil del usuario" [modal]="true" [(visible)]="modal" [style]="{ width: '45rem' }">
    <div class="grid">
        <div class="col-4">
            <div class="flex flex-column mt-2 gap-3">
                <div class="flex justify-content-center">
                    <div class="image-circle">
                        <img [src]="infoUser.avatar_url" alt="" width="200px">
                    </div>
                </div>
                <div class="flex flex-column">
                    <label class="">Nombre</label>
                    <b class="font-bold text-3xl">{{infoUser.login}}</b>
                </div>
                <div class="flex flex-column">
                    <label class="">Id</label>
                    <b class="font-bold text-3xl">{{infoUser.id}}</b>
                </div>
                <div class="flex flex-column">
                    <label class="">Seguidores</label>
                    <b class="font-bold text-3xl">{{infoUser.followers}}</b>
                </div>
                <div class="flex flex-column">
                    <label class="">Seguidos</label>
                    <b class="font-bold text-3xl">{{infoUser.following}}</b>
                </div>
                <div class="flex flex-column">
                    <label class="">Fecha de creación</label>
                    <b class="font-bold text-3xl">{{infoUser.created_at | date: 'dd MMMM yyyy'}}</b>
                </div>
            </div>
        </div>
        <div class="col-8">
            <div class="flex flex-column gap-4 justify-content-center">
                <iframe width="400" height="315" src="https://www.youtube.com/embed/mVjYG9TSN88" frameborder="0"
                    allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture"
                    allowfullscreen></iframe>
                <p-button label="Guardar" icon="fa-solid fa-floppy-disk" [raised]="true" (onClick)="onSaveInfoUser()"
                    [loading]="loading"></p-button>
            </div>
        </div>
    </div>

</p-dialog>